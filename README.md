# Классификация твитов о бедствиях (Twitter Disaster NLP)

Веб-приложение и модель машинного обучения для бинарной классификации коротких текстов: определение постов из Twitter, описывающих **реальное бедствие**, от обычных сообщений.

**Сроки проекта:** 01.09.2025 — 01.02.2026  

**Система планирования:** канбан-доска (этапы и задачи описаны в [PROJECT.md](PROJECT.md)).

---

## Состав команды и роли

| Участник | Роли |
|----------|------|
| **Казимиров Никита** | Программист, Scrum-мастер |
| **Хромушин Станислав** | Технический писатель |
| **Попов Константин** | Программист, Архитектор, Тестировщик |

---

## Технологии

- **Python 3**
- **TensorFlow / Keras** — нейросетевая модель (Embedding + LSTM)
- **Flask** — веб-интерфейс
- **pandas, scikit-learn** — данные и разбиение выборок

---

## Структура проекта

```
PI/
├── README.md           # этот файл
├── PROJECT.md          # план проекта, канбан, задачи по ролям
├── train.py            # обучение модели на train.csv
├── test.py             # предсказания для test.csv (офлайн)
├── app.py              # веб-интерфейс (форма + загрузка CSV)
├── train.csv           # обучающая выборка (id, keyword, location, text, target)
├── test.csv            # тестовая выборка (id, keyword, location, text)
├── disaster_model.h5   # сохранённая модель Keras
├── tokenizer.pkl       # токенайзер (сохраняется после train.py)
└── metrics.txt         # метрика accuracy на валидации
```

---

## Установка и запуск

### 1. Зависимости

```bash
pip install tensorflow pandas scikit-learn flask
```

### 2. Обучение модели

```bash
python train.py
```

Скрипт читает `train.csv`, обучает модель, сохраняет `disaster_model.h5`, `tokenizer.pkl` и записывает accuracy в `metrics.txt`.

### 3. Предсказания по файлу test.csv (офлайн)

```bash
python test.py
```

Создаёт `test_predictions.csv` и при наличии колонки `id` — `submission.csv`.

### 4. Веб-интерфейс

```bash
python app.py
```

В браузере открыть: **http://127.0.0.1:5000**

- **Единичный твит** — ввод текста, получение предсказания (бедствие / нет) и вероятности.
- **Загрузка CSV** — загрузка файла с колонкой `text`; скачивание CSV с колонками `prediction` и `probability`.
- На странице отображается **Accuracy на валидации** (из `metrics.txt`).

---

## Формат данных

- **train.csv**: колонки `id`, `keyword`, `location`, `text`, `target` (0 — не бедствие, 1 — бедствие).
- **test.csv**: те же колонки, кроме `target`; для веб-загрузки достаточно колонки `text` (и при необходимости `id`).

---

## Метрики

- **Accuracy** — доля правильных ответов на валидационной выборке; вычисляется в `train.py`, сохраняется в `metrics.txt` и отображается в веб-интерфейсе.

---

## Лицензия и использование

Учебный проект. Датасет — открытые данные (Kaggle NLP Disaster Tweets и аналоги).
